---
name: requesting-code-review
description: 当完成功能开发、修复 Bug 或准备合并分支时使用，以发起高质量的审查请求。
---

# 发起代码审查请求 (Requesting Code Review)

## 概述

本技能要求在提交审查前完成自审与上下文注入，确保审查者能聚焦风险与逻辑。

**核心原则**
1. **自审先行**：未自审不得请求审查。
2. **上下文完整**：必须说明为什么、做了什么、风险与验证。
3. **风险自述**：主动暴露潜在风险与未覆盖场景。

## 何时使用

- 功能开发或 Bug 修复完成。
- 准备合并至主分支。

## 强制流程 (Workflow)

### 1. 自审清单
- 运行全部相关测试与静态检查。
- 逐行审阅 `git diff`。
- 清理调试代码与无关改动。

### 2. PR 模板 (强制)

```markdown
# PR 审查请求

## 1. 动机 (Why)
- 需求/问题链接:
- 目标:

## 2. 核心变更 (What)
- 逻辑/流程:
- 结构/接口:

## 3. 风险自述 (Risks)
- 破坏性变更:
- 数据迁移:
- 性能影响:
- 未覆盖的场景:

## 4. 验证证据 (Verification)
- 命令:
- 结果日志:
```

### 3. 变更粒度约束
- 单 PR 建议不超过 300 行差异。
- 只解决一个问题；多问题必须拆分。

## 禁令
- 禁止未通过测试即请求审查。
- 禁止缺失风险自述。
- 禁止混杂无关改动。

## 借口粉碎机 (Excuse Smasher)

| 借口 | 事实反击 |
|------|----------|
| “审查者看得懂，不用写背景” | 背景缺失会增加审查成本与误判。 |
| “风险很小，不用写” | 风险不写等于让审查者盲评。 |
| “改动太多拆不开” | 不拆分是设计问题，需要重构方案。 |

## 危险信号 (Red Flags)

- PR 模板缺失或空白。
- 没有风险自述。
- 未提供验证日志。
- 变更粒度过大。
