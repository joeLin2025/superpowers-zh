---
name: brainstorming
description: 当需要进行新功能开发、架构设计、重构或解决模糊问题，且需将需求转化为具体技术规范时使用。
---

# 深度脑暴与设计 (Brainstorming)

## 概述

本技能将“模糊需求”转化为可审计的设计规格与决策记录，强制输出双方案权衡、风险矩阵与反向压力测试，避免未经验证的直觉驱动实现。

**核心原则**
1. **设计物化**：产出必须是可版本化的 Spec/ADR 文档，而非对话口述。
2. **强制权衡**：至少两个本质不同的方案，并进行明确对比。
3. **证据驱动**：设计依据必须来自上下文审计与外部参考。

## 何时使用

- 新功能、架构调整、跨模块重构。
- 复杂问题未明确修复路径。
- 需要将需求落地为可执行规格。

## 强制流程 (Workflow)

### 1. 上下文审计 (Context Audit)
**必须**先做：
- `list_directory` 或等效命令确认目录结构。
- `read_file` 读取关键文件片段。
- **禁令**：没有文件路径引用不得讨论方案。

### 2. 设计思维框架注入
在构思时必须覆盖以下阶段：
- **同理**：谁在用、痛点是什么。
- **定义**：问题边界与成功标准。
- **构思**：至少 2 个方案。
- **原型**：最小验证路径。
- **测试**：验证方式与失败信号。

### 3. 双方案权衡 (Dual-Path)
**必须**输出 A/B 两方案，并在表格中对比：
- 实现难度
- 维护成本
- 性能影响
- 风险

### 4. 反向压力测试 (Reverse Stress Test)
**必须**回答：
- 哪些关键假设如果不成立会失败。
- 最坏情况下会破坏哪些模块。
- 是否需要回滚或迁移策略。

### 5. 输出 Spec/ADR
**必须**保存到 `docs/specs/[YYYY-MM-DD]-[task].md`。若目录不存在，创建 `docs/specs`。

**Spec/ADR 模板（强制）**

```markdown
# [Spec Title]

## 1. 背景与目标 (Context & Goals)
- **痛点**: 
- **目标**: 
- **非目标 (Non-Goals)**: 

## 2. 核心设计 (Core Design)
- **API 变更**: 
- **数据结构**: 
- **逻辑流**: 

## 3. 方案权衡 (Trade-offs)
| 维度 | 方案 A (推荐) | 方案 B (替代) |
| :--- | :--- | :--- |
| **实现难度** |  |  |
| **维护成本** |  |  |
| **性能影响** |  |  |
| **风险** |  |  |

## 4. 反向压力测试 (Reverse Stress Test)
- **关键假设**: 
- **失败模式**: 
- **回滚/迁移**: 

## 5. 风险与副作用 (Risks & Side Effects)
- **受影响文件**: 
- **破坏性变更**: 
```

### 6. 禁止实施泄漏
- 禁止输出完整实现步骤或超过 10 行实现代码。
- Spec 未获批准前禁止进入 `writing-plans`。

## 借口粉碎机 (Excuse Smasher)

| 借口 | 事实反击 |
|------|----------|
| “这很简单，不需要两方案” | 直觉常常忽略边界条件，强制双方案可暴露隐性风险。 |
| “先写代码再补文档” | 先执行会固化错误路径，Spec 是唯一可审计依据。 |
| “不需要反向压力测试” | 未验证的假设会在最坏场景下放大为系统性故障。 |

## 危险信号 (Red Flags)

- 没有输出 Spec/ADR 文件。
- 未给出方案 B 或无对比表。
- 未包含反向压力测试章节。
- 没有引用具体文件路径或上下文证据。
