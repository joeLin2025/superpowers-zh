---
name: brainstorming
description: 当需要进行新功能开发、架构设计、重构或解决模糊问题，且需要将需求转化为具体的技术规范时使用。
---

# 深度脑暴与设计 (Deep Brainstorming & Design)

## 概述

此技能强制在编写任何代码之前进行彻底的、结构化的探索。

**核心原则：**
1.  **先思考后行动**：严禁在理解清楚“为什么”和“怎么做”之前动手写代码。
2.  **穷尽可能性**：必须探索多个方案，权衡利弊，而不是接受第一个闪现在脑海中的想法。
3.  **文档驱动**：脑暴的产出**必须**是一份结构清晰、可被执行的设计文档。

## 何时使用

- 接到新功能开发请求时。
- 需要解决复杂的系统性问题或重构时。
- 只有模糊的目标（如“优化性能”）而没有具体路径时。
- 发现自己正在“凭感觉”写代码时。

**何时不使用：**
- 简单的拼写错误修复。
- 极小的、显而易见的配置更改。

## 核心法则

### 1. 必须进行上下文初始化与信息采集
在提出方案之前，**必须**基于事实进行分析：
- 使用 `list_directory` 和 `read_file` 确认相关模块的现有实现。
- **严禁**基于假设进行设计。你**必须**引用实际的文件路径和代码片段。

### 2. 必须执行结构化设计流程 (Spec First)
你必须按照以下步骤引导，严禁跳步：
1.  **需求澄清**：复述目标，识别边界。
2.  **方案对比**：至少提出 2 个不同维度的方案，并明确优缺点（复杂度、扩展性、风险）。
3.  **产出设计文档 (Technical Spec)**：脑暴的终点**必须**是在 `docs/specs/` 目录下创建一个 Markdown 文件（如 `2024-05-20-new-auth-system.md`）。

### 3. 设计文档 (Spec) 的强制结构
设计文档**必须**使用中文编写（专业术语保持英文），并包含以下核心章节，不得遗漏：
- **背景与目标 (Context & Goals)**：为什么要这么做？要达到什么效果？
- **核心设计 (Core Design)**：
    - **API 变更**：具体的函数签名、接口定义。
    - **数据结构**：数据模型或核心配置的变动。
    - **逻辑流**：关键算法的伪代码或流程说明（推荐使用 Mermaid 图）。
- **风险与副作用 (Risks & Side Effects)**：这次变动会影响哪些现有功能？有哪些潜在风险？
- **替代方案 (Alternatives Considered)**：为什么选择了当前的方案而不是其他的？

### 4. 严禁越界执行
- **严禁**在脑暴阶段编写细粒度的“第一步、第二步”施工步骤。这是 `writing-plans` 的职责。
- **严禁**在用户批准 Spec 之前开始任何编码。
- **明确交接**：脑暴结束时，必须宣布：“设计文档已就绪并获得批准。现在可以交由 `writing-plans` 技能来拆解执行计划。”

## 借口粉碎机 (Excuse Smasher)

| 借口 | 事实反击 |
|------|----------|
| “这个功能很小，不用写 Spec” | 模糊的设计是 Bug 的温床。写 Spec 是为了理清逻辑，防止在写代码时才发现走不通。 |
| “我已经在对话里说清楚了” | 对话记录会被滚动淹没。只有持久化的 Spec 才能作为后续 `writing-plans` 的稳定输入。 |
| “写文档太慢了” | 在代码阶段发现架构错误，修复成本是写文档的 100 倍。 |

## 危险信号 (Red Flags)

- **直接给代码**：在没有产出 Spec 文档的情况下直接给出大量实现代码。
- **缺乏权衡**：只给出一个方案，没有任何替代路径的对比。
- **逻辑断层**：产出的 Spec 中没有提到对现有系统的副作用。
- **角色混乱**：在脑暴阶段就开始讨论具体的 git 提交策略或目录创建顺序。