---
name: brainstorming
description: 当需要进行新功能开发、架构设计、重构或解决模糊问题，且需将需求转化为具体技术规范时使用。
---

# 深度脑暴与设计 (Brainstorming)

## 概述

本技能用于将“模糊需求”转化为可审计的设计规格（Spec），强制输出双方案权衡、风险与副作用，避免凭直觉推进实现。

## 何时使用

- 新功能、架构调整、跨模块重构。
- 复杂问题尚无明确修复路径。
- 用户提出“怎么做 / 方案 / 架构 / 设计”。

**触发关键词**: `新需求 / 怎么做 / 架构 / 设计 / 方案`

## 强制流程 (Workflow)

### 1. 上下文审计
- 必须基于实际仓库上下文进行审计，禁止仅凭记忆推断。
- 必须列出关键文件路径与模块边界。

### 2. 双方案权衡
- 必须给出至少 2 个本质不同方案（A 推荐 / B 替代）。
- 必须用表格比较实现难度、风险、维护成本、性能影响。

### 3. 产出 Spec
- 必须输出 Spec 文件：`docs/specs/[YYYY-MM-DD]-[task-name].md`。
- 目录不存在时必须创建。
- 禁止在 Spec 前进入计划或实现。

### 4. 风险与副作用评估
- 必须列出受影响文件路径。
- 必须标记潜在破坏性变更与迁移需求。

### 5. 禁止实施泄漏
- 禁止产出实现级步骤或代码。
- 禁止绕过 Spec 直接进入 `writing-plans`。

## 输出物 (Artifacts)

- **必须生成 Spec 文件**，并严格使用以下模板，禁止偏离：

```markdown
# [Spec Title]

## 1. 背景与目标 (Context & Goals)
- **痛点**:
- **目标**:
- **非目标 (Non-Goals)**:

## 2. 核心设计 (Core Design)
- **API 变更**:
- **数据结构**:
- **流程/伪代码**:

## 3. 方案权衡 (Trade-offs)
| 维度 | 方案 A (推荐) | 方案 B (替代) |
| :--- | :--- | :--- |
| 复杂度 |  |  |
| 风险 |  |  |
| 维护成本 |  |  |
| 性能影响 |  |  |

## 4. 风险与副作用 (Risks & Side Effects)
- **受影响文件**:
- **破坏性变更**:
```

## 验证与证据 (Verification & Evidence)

- 必须验证 Spec 文件已创建且包含全部章节。
- 若使用外部信息，只记录在执行记录中，不写入技能文档。

## 对抗测试 (Adversarial Tests)

- 试图跳过“上下文审计”直接给方案，必须拒绝并先列出关键文件路径与模块边界。
- 只提供单一方案或缺失权衡表，必须补齐双方案与对比表格。
- 在 Spec 未生成前要求进入计划或实现，必须停止并要求产出 Spec。
## 红旗/反例 (Red Flags & Anti-Patterns)

- 未产出 Spec 就进入实现或计划。
- 仅给出单一方案。
- 未列出受影响文件路径。
- 方案描述停留在口号级别。

## 例外与降级策略 (Exceptions & Degrade)

- 若缺少必要上下文，必须先提出最小信息清单并等待补齐。
- 若用户拒绝 Spec，必须停止执行并说明“无 Spec 不行动”。

## 工具映射 (Tool Mapping)

- `list_directory` -> `Get-ChildItem`
- `read_file` -> `Get-Content`
- `write_file` -> `Set-Content`
- `run_shell_command` -> `shell_command`

