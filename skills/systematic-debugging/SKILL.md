---
name: systematic-debugging
description: 当遇到 Bug、测试失败或非预期行为时，在提出修复方案前使用，以确保基于证据的科学排障。
---

# 系统化调试 (Systematic Debugging)

## 概述

本技能要求在任何修复前先建立可复现、可验证、可审计的证据链，杜绝猜测式修复。

**核心原则**
1. **无复现不修复**：没有稳定复现，禁止改代码。
2. **单变量验证**：一次只改变一个因素。
3. **证据链闭环**：结论必须来自日志、堆栈或实验结果。

## 何时使用

- 测试失败或运行异常。
- 行为与预期不一致但无明确原因。

## 强制流程 (Workflow)

### 1. 环境审计
- 清理缓存/依赖噪音。
- 记录环境版本与依赖版本。

### 2. MRE (Minimal Reproducible Example)
- 必须创建最小可复现脚本或测试。
- 复现必须稳定（>=2 次一致失败）。

### 3. 假设-验证
- 明确假设：问题发生在哪个文件/行/条件。
- 设计实验验证假设。

### 4. 二分定位
- 使用二分法缩小问题范围。
- 禁止同时改动多个变量。

### 5. RCA (Root Cause Analysis)
**必须输出**以下模板：

```
【现象】
【直接原因】
【根因】
【触发条件】
【预防措施】
```

### 6. 修复与回归
- 修复后先跑 MRE，再跑全量回归。
- 必须新增回归测试。

## 禁令
- 禁止无 MRE 直接修复。
- 禁止“试试看”式改动。
- 禁止跳过 RCA。

## 借口粉碎机 (Excuse Smasher)

| 借口 | 事实反击 |
|------|----------|
| “我知道原因，直接修” | 直觉易误导，没有证据就没有修复。 |
| “复现太麻烦” | 无复现的修复不可验证，等于无效。 |
| “先加 if 兜底” | 掩盖症状会阻止根因定位。 |

## 危险信号 (Red Flags)

- 反复试错仍未验证假设。
- 没有 MRE 但开始改代码。
- 只修症状不修根因。
- 修复后没有新增回归测试。
