---
name: subagent-driven-development
description: 当在当前会话中执行涉及复杂逻辑、多步骤实施或需要严格隔离审查的计划任务时使用。
---

# 子代理驱动开发 (Subagent-Driven Development)

## 概述

本技能将复杂任务分解给具备明确职责的子代理，并通过零信任审计与双层审查防止偏差与漏改。

**核心原则**
1. **角色纯净**：实现者不做审查，审查者不写实现。
2. **零信任审计**：任何子代理输出必须被验证。
3. **闭环委派**：必须有明确任务边界、输入与验收标准。

## 何时使用

- 多步骤、复杂实现需要隔离执行与审查。
- 并行执行多个原子任务。

## 强制流程 (Workflow)

### 1. 委派握手协议
委派前必须明确：
- **任务边界**：可修改文件白名单。
- **验收标准**：测试/验证要求。
- **交付格式**：JSON 报告。

### 2. 执行与隔离
- 子代理不得修改白名单外文件。
- 发现范围外需求必须回报主代理。

### 3. 双层审查
- **规格审查**：是否完成需求。
- **质量审查**：风格、健壮性、可维护性。

### 4. JSON 汇报格式 (强制)

```
{
  "files_changed": ["path:line"],
  "tests_run": ["command"],
  "evidence": ["log snippet"],
  "risks": ["known gaps"],
  "needs_followup": ["open questions"]
}
```

## 禁令
- 禁止子代理修改白名单外文件。
- 禁止未审查直接合并。
- 禁止用自然语言替代 JSON 报告。

## 借口粉碎机 (Excuse Smasher)

| 借口 | 事实反击 |
|------|----------|
| “任务太小，不需要委派” | 小任务更易被忽视，委派能保持主代理清晰度。 |
| “审查太慢” | 没有审查的输出不可用。 |
| “子代理知道上下文，不用写清楚” | 子代理是无状态的，必须明确边界。 |

## 危险信号 (Red Flags)

- 子代理未提供 JSON 报告。
- 未进行双层审查即合并。
- 子代理越权修改。
