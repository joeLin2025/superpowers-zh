---
name: writing-plans
description: 当持有已批准的设计规格 (Spec)，并准备进入多步骤实施阶段前使用，用于产出可追踪的执行蓝图。
---

# 编写实施计划 (Writing Plans)

## 概述

本技能将已批准的 Spec 转换为可执行计划，强制遵守 WBS 分解与验证闭环，保证计划可追踪、可纠偏、可复现。

**核心原则**
1. **先计划后执行**：无计划不得实施。
2. **WBS 100% 规则**：计划必须覆盖全部交付范围，不重叠、不遗漏。
3. **可验证性**：每个任务必须定义验证方法。
4. **可中断可续**：计划必须支持断点续传与动态纠偏。

## 何时使用

- Spec 已通过批准。
- 任务涉及多文件、多步骤或高风险变更。
- 需要在执行前定义清晰的检查点与回滚策略。

## 强制流程 (Workflow)

### 1. Zero-Point Check
在创建计划前**必须**确认并记录：
- **工作区模式**：Current Directory 或 Worktree。
- **交付模式**：Local Auto-commit 或 Manual。

### 2. WBS 分解规则
- **交付物导向**：以成果/组件为单位拆分，不以“动作”当主维度。
- **粒度约束**：单个任务的代码变更不超过 50 行（模板/生成文件除外）。
- **100% 覆盖**：所有范围必须被任务覆盖，任务之间不得重复。

### 3. 计划模板 (强制)
计划文件路径：`docs/plans/[YYYY-MM-DD]-[task-name].md`。

```markdown
# [Plan Title]

**依据文档**: [Spec Link]
**目标**: [简述目标]

## 决策记录 (Decisions)
- **工作区模式**: [Current Directory / Worktree]
- **交付模式**: [Local Auto-commit / Manual]

## 全局执行规则 (Global Rules)
- [必须列出关键约束]

## 任务清单 (Tasks)

- [ ] **Task 01: [原子任务名]**
  - [ ] 动作: [具体动作]
  - [ ] 验证: [具体测试命令或检查方式]
  - [ ] Review Checkpoint: [需要用户/系统审查的内容]

- [ ] **Task 02: [原子任务名]**
  - [ ] 动作: [具体动作]
  - [ ] 验证: [具体测试命令或检查方式]
  - [ ] Review Checkpoint: [需要用户/系统审查的内容]
```

### 4. 断点续传与动态纠偏
- **断点续传**：每个任务结束后必须记录完成状态与证据。
- **动态纠偏**：若发现计划与现实偏离，必须先更新计划再继续执行。

## 禁令
- 禁止在未创建计划文件前执行任何实现。
- 禁止省略验证步骤或 Review Checkpoint。
- 禁止用“泛化动作”描述任务（如“完善逻辑”）。

## 借口粉碎机 (Excuse Smasher)

| 借口 | 事实反击 |
|------|----------|
| “计划太慢，先写点代码” | 计划是执行的唯一合法入口，先写只会制造返工。 |
| “不需要 Review Checkpoint” | 缺少审查点会导致偏差累积与不可追踪错误。 |
| “任务已经很清楚了，不需要 WBS” | 没有 WBS 就无法保证范围完整与任务边界清晰。 |

## 危险信号 (Red Flags)

- 计划中缺失 Review Checkpoint。
- 任务没有明确验证方式。
- 计划未引用已批准的 Spec。
- 计划与实际执行不一致但未更新。
