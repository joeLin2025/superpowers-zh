---
name: finishing-a-development-branch
description: 当实施完成、所有测试通过，并且需要决定如何集成工作或准备发起 PR 时使用。
---

# 完成开发分支与集成 (Finishing a Development Branch)

## 概述

本技能确保合并前的代码质量与历史整洁，避免把临时状态带入主干。

**核心原则**
1. **全量验证**：测试与 Lint 必须全量通过。
2. **环境净化**：清理临时日志、调试代码与垃圾文件。
3. **历史整洁**：提交历史必须原子且有意义。

## 何时使用

- 计划任务全部完成并验证通过。
- 准备发起 PR 或合并至主干。

## 强制流程 (Workflow)

### 1. 全量验证
- 运行全量测试与静态检查。
- 任何失败视为未完成。

### 2. 环境净化
- 删除调试日志、临时脚本、未跟踪文件。
- 清理被注释的大块死代码。

### 3. 历史审计与清理
- 检查提交历史，合并碎片提交。
- 规范提交信息格式。

### 4. 同步主干
- `git fetch` 获取最新主干。
- rebase 到最新主干并解决冲突。
- 冲突解决后必须重新跑全量测试。

## 禁令
- 禁止带着测试失败或 Lint 警告合并。
- 禁止保留调试日志。
- 禁止混乱提交历史进入主干。

## 借口粉碎机 (Excuse Smasher)

| 借口 | 事实反击 |
|------|----------|
| “这次改动很小，不用全量测试” | 小改动也可能触发隐性依赖。 |
| “日志先留着” | 临时日志属于垃圾，必须清理。 |
| “rebase 太危险” | 历史整洁是主干质量保证。 |

## 危险信号 (Red Flags)

- 测试失败仍尝试合并。
- 残留调试代码。
- 提交历史包含大量无意义提交。
